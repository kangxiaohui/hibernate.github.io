<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
    
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
  <title>
     神秘的小胖纸
  </title>
  <meta name="generator" content="hexo-theme-yilia-plus">
  
  <link rel="shortcut icon" href="/favicon.ico" />
  
  
<link rel="stylesheet" href="/css/style.css">

  
<script src="/js/pace.min.js"></script>


  

  

<link rel="alternate" href="/atom.xml" title="神秘的小胖纸" type="application/atom+xml">
</head>

</html>

<body>
  <div id="app">
    <main class="content">
      
<section class="cover">
    
  <div class="cover-frame">
    <div class="bg-box">
      <img src="/images/cover1.jpg" alt="image frame" />
    </div>
    <div class="cover-inner text-center text-white">
      <h1><a href="/">神秘的小胖纸</a></h1>
      <div id="subtitle-box">
        
        <span id="subtitle"></span>
        
      </div>
      <div>
        
      </div>
    </div>
  </div>
  <div class="cover-learn-more">
    <a href="javascript:void(0)" class="anchor"><i class="ri-arrow-down-line"></i></a>
  </div>
</section>



<script src="https://cdn.jsdelivr.net/npm/typed.js@2.0.11/lib/typed.min.js"></script>

<div id="main">
  <section class="outer">
  <article class="articles">
    
    
    
    
    <article id="post-4-Hibernate一对一关联映射" class="article article-type-post" itemscope
  itemprop="blogPost" data-scroll-reveal>

  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2020/02/26/4-Hibernate%E4%B8%80%E5%AF%B9%E4%B8%80%E5%85%B3%E8%81%94%E6%98%A0%E5%B0%84/"
    >4-Hibernate一对一关联映射</a
  >
</h2>
  

    </header>
    

    
    <div class="article-meta">
      <a href="/2020/02/26/4-Hibernate%E4%B8%80%E5%AF%B9%E4%B8%80%E5%85%B3%E8%81%94%E6%98%A0%E5%B0%84/" class="article-date">
  <time datetime="2020-02-26T01:03:24.000Z" itemprop="datePublished">2020-02-26</time>
</a>
      
  <div class="article-category">
    <a class="article-category-link" href="/categories/hibernate/">hibernate</a>
  </div>

      
      
      
    </div>
    

    

    
    <div class="article-entry" itemprop="articleBody">
      


      

      
      <h1 id="Hibernate一对一关联映射"><a href="#Hibernate一对一关联映射" class="headerlink" title="Hibernate一对一关联映射"></a>Hibernate一对一关联映射</h1><p>实体之间的联系：<br/></p>
<ol>
<li>一对一联系（1:1）</li>
<li>一对多联系（1:n）</li>
<li>多对多联系（m:n）</li>
</ol>
<h2 id="一对一的关联映射（主键关联方式）"><a href="#一对一的关联映射（主键关联方式）" class="headerlink" title="一对一的关联映射（主键关联方式）"></a>一对一的关联映射（主键关联方式）</h2><h3 id="xml方式"><a href="#xml方式" class="headerlink" title="xml方式"></a>xml方式</h3><p>实体类<br>User.java</p>
<pre><code>public class User {
    private int id;
    private String userName;
    private String password;
    private Person person;
    ……
}</code></pre><p>Persion.java</p>
<pre><code>public class Person {
    private Integer id;
    private String name;
    private String idNumber;
    private User user;
    ……
}</code></pre><p>User.hbm.xml</p>
<pre><code>&lt;class name=&quot;User&quot;&gt;
    &lt;id name=&quot;id&quot; &gt;
        &lt;generator class=&quot;increment&quot;&gt;&lt;/generator&gt;
    &lt;/id&gt;
    &lt;property name=&quot;userName&quot;  /&gt;
    &lt;property name=&quot;password&quot;/&gt;

    &lt;!-- 主键关联方式映射与Person的一对一关系 --&gt;
    &lt;one-to-one name=&quot;person&quot; class=&quot;Person&quot; cascade=&quot;all&quot;/&gt;
&lt;/class&gt;</code></pre><p>Persion.hbm.xml</p>
<pre><code>&lt;class name=&quot;Person&quot;&gt;
    &lt;id name=&quot;id&quot; &gt;
        &lt;generator class=&quot;foreign&quot;&gt;
            &lt;param name=&quot;property&quot;&gt;user&lt;/param&gt;
        &lt;/generator&gt;
    &lt;/id&gt;

    &lt;!-- 主键关联方式映射与User的一对一关系 --&gt;
    &lt;one-to-one name=&quot;user&quot; constrained=&quot;true&quot; /&gt;
    &lt;property name=&quot;name&quot; /&gt;
    &lt;property name=&quot;idNumber&quot;/&gt;

&lt;/class&gt;</code></pre><p>Test.java</p>
<pre><code>public static void saveUser() {
    Session session = null;
    Transaction tran = null;
    try {
        session = HibernateUtil.openSession();
        tran = session.beginTransaction();// 开启事务

        // 新建User对象
        User user = new User();
        user.setUserName(&quot;张三&quot;);
        user.setPassword(&quot;111111&quot;);

        //新建Person对象
        Person person = new Person();
        person.setName(&quot;张三&quot;);
        person.setIdNumber(&quot;100345199002031234&quot;);

        //建立联系
        user.setPerson(person);
        person.setUser(user);

        // 保存user并级联保存person
        session.save(user);

        tran.commit();// 提交事务

    } catch (Exception e) {
        tran.rollback();// 回滚事务
        e.printStackTrace();
    } finally {
        session.close();// 关闭session
        HibernateUtil.closeSessionFactory();
    }
}</code></pre><h3 id="注释方法"><a href="#注释方法" class="headerlink" title="注释方法"></a>注释方法</h3><p>User.java</p>
<pre><code>@Entity
@Table(name=&quot;user&quot;)
public class User {
    //注解写在属性上使用的是反射机制
    //注解写在get方法上，是setget机制
    private int id;
    private String userName;
    private String password;
    private Person person;

    @Id
    @GeneratedValue(generator=&quot;my_gen&quot;)
    @GenericGenerator(name=&quot;my_gen&quot;, strategy=&quot;increment&quot;)
    public int getId() {
        return id;
    }

    public void setId(int id) {
        this.id = id;
    }

    public String getUserName() {
        return userName;
    }

    public void setUserName(String userName) {
        this.userName = userName;
    }

    public String getPassword() {
        return password;
    }

    public void setPassword(String password) {
        this.password = password;
    }

    @OneToOne(cascade=CascadeType.ALL)
    @PrimaryKeyJoinColumn(name=&quot;id&quot;)
    public Person getPerson() {
        return person;
    }

    public void setPerson(Person person) {
        this.person = person;
    }

}</code></pre><p>Persion.java</p>
<pre><code>@Entity
@Table(name=&quot;person&quot;)
public class Person {

    private Integer id;
    private String name;//姓名
    private String idNumber;//身份证号
    private User user;

    @Id
    @GeneratedValue(generator=&quot;my_gen&quot;)
    @GenericGenerator(name=&quot;my_gen&quot;, strategy = &quot;foreign&quot;, parameters= {@Parameter(name = &quot;property&quot;, value = &quot;user&quot;)})
    public Integer getId() {
        return id;
    }
    public void setId(Integer id) {
        this.id = id;
    }
    public String getName() {
        return name;
    }
    public void setName(String name) {
        this.name = name;
    }
    public String getIdNumber() {
        return idNumber;
    }
    public void setIdNumber(String idNumber) {
        this.idNumber = idNumber;
    }

    @OneToOne(mappedBy=&quot;person&quot;)
    public User getUser() {
        return user;
    }
    public void setUser(User user) {
        this.user = user;
    }

}</code></pre><p>Test.java</p>
<pre><code>public static void saveUser() {
    Session session = null;
    Transaction tran = null;

    try {
        session = HibernateUtil.openSession();
        tran = session.beginTransaction();// 开启事务

        // 新建User对象
        User user = new User();
        user.setUserName(&quot;张三&quot;);
        user.setPassword(&quot;111112&quot;);

        // 新建Person对象
        Person person = new Person();
        person.setName(&quot;zs&quot;);
        person.setIdNumber(&quot;111345199002031234&quot;);

        // 建立联系
        user.setPerson(person);
        person.setUser(user);

        // 保存user并级联保存person
        session.save(user);

        tran.commit();// 提交事务

    } catch (Exception e) {
        tran.rollback();// 回滚事务
        e.printStackTrace();
    } finally {
        session.close();// 关闭session
        HibernateUtil.closeSessionFactory();
    }
}</code></pre><p><strong>关于上述代码解释：</strong></p>
<ol>
<li>xml：<ol>
<li>通过<one-to-one> 元素配置。—–（主键表）<ol>
<li>ascade属性（级联属性）为 all：:对象所有操作进行级联操作  save,update,delete</li>
<li>ascade属性（级联属性）为 save-update :  执行保存和更改操作时进行级联操作</li>
<li>ascade属性（级联属性）为 delete :  执行删除操作时进行级联操作</li>
<li>ascade属性（级联属性）为 none : 对所有操作不进行级联操作       默认</li>
</ol>
</li>
<li>constrained 属性为 true，表明 PERSON 表ID为外键，参照主表USER—–（外键表）</li>
<li>外键表实体类配置文件中 OID 使用 foreign 生成策略。—–（外键表）</li>
</ol>
</li>
<li>注解：<ol>
<li>User端的person属性配置<ol>
<li>@OneToOne(cascade=CascadeType.ALL) ：指定一对一关联关系，并设置级联属性。</li>
<li>@PrimaryKeyJoinColumn(name=”ID”) ：指定Persion表主键列名。</li>
</ol>
</li>
<li>在Person端的id属性上配置主键生成策略为 foreign<br><ol>
<li><code>@GeneratedValue(generator=&quot;foreign&quot;)</code></li>
<li><code>@GenericGenerator(name=&quot;foreign&quot;,strategy=&quot;foreign&quot;,parameters={@Parameter(name=&quot;property&quot;,value=&quot;user&quot;)})</code></li>
</ol>
</li>
<li>在Person一端的user属性上配置一对一关联关系<br><br><code>@OneToOne(mappedBy=&quot;person&quot;)</code></li>
</ol>
</li>
</ol>
<h2 id="一对一的关联映射（唯一外键关联方式）"><a href="#一对一的关联映射（唯一外键关联方式）" class="headerlink" title="一对一的关联映射（唯一外键关联方式）"></a>一对一的关联映射（唯一外键关联方式）</h2><h3 id="xml方式-1"><a href="#xml方式-1" class="headerlink" title="xml方式"></a>xml方式</h3><p>User.java</p>
<pre><code>public class User {
    private int id;
    private String userName;
    private String password;
    private Person person;
    ......

}</code></pre><p>User.hbm.xml</p>
<pre><code>&lt;class name=&quot;User&quot; table=&quot;USER&quot;&gt;
    &lt;id name=&quot;id&quot; &gt;
        &lt;generator class=&quot;increment&quot;&gt;&lt;/generator&gt;
    &lt;/id&gt;
    &lt;property name=&quot;userName&quot;  /&gt;
    &lt;property name=&quot;password&quot;/&gt;

    &lt;!-- 外键关联方式映射与Person的一对一关系 --&gt;
    &lt;many-to-one name=&quot;person&quot; column=&quot;PERSONID&quot; cascade=&quot;all&quot; unique=&quot;true&quot;/&gt;
&lt;/class&gt;</code></pre><p>Persion.java</p>
<pre><code>public class Person {
    private Integer id;
    private String name;//姓名
    private String idNumber;//身份证号
    private User user;
    ......
}</code></pre><p>Persion.hbm.xml</p>
<pre><code>&lt;class name=&quot;Person&quot; table=&quot;PERSON&quot;&gt;
    &lt;id name=&quot;id&quot;&gt;
        &lt;generator class=&quot;increment&quot;&gt;&lt;/generator&gt;
    &lt;/id&gt;
    &lt;property name=&quot;name&quot; /&gt;
    &lt;property name=&quot;idNumber&quot; /&gt;

    &lt;!-- 外键关联方式映射与User的一对一关系   property-ref:外键列对应的属性名 --&gt;
    &lt;one-to-one name=&quot;user&quot; property-ref=&quot;person&quot; /&gt;
&lt;/class&gt;</code></pre><p>测试类同上</p>
<h3 id="注解方式"><a href="#注解方式" class="headerlink" title="注解方式"></a>注解方式</h3><p>User.java</p>
<pre><code>@Entity
@Table(name=&quot;USER&quot;)
public class User {

    private int id;
    private String userName;
    private String password;
    private Person person;

    @Id
    @GeneratedValue(generator=&quot;my_gen&quot;)
    @GenericGenerator(name=&quot;my_gen&quot;, strategy = &quot;increment&quot;)
    public int getId() {
        return id;
    }

    public void setId(int id) {
        this.id = id;
    }

    public String getUserName() {
        return userName;
    }

    public void setUserName(String userName) {
        this.userName = userName;
    }

    public String getPassword() {
        return password;
    }

    public void setPassword(String password) {
        this.password = password;
    }

    @OneToOne(cascade=CascadeType.ALL)
    @JoinColumn(name=&quot;PERSONID&quot;)
    public Person getPerson() {
        return person;
    }

    public void setPerson(Person person) {
        this.person = person;
    }

}</code></pre><p>Persion.java</p>
<pre><code>@Entity
@Table(name=&quot;PERSON&quot;)
public class Person {

    private Integer id;
    private String name;//姓名
    private String idNumber;//身份证号
    private User user;

    @Id
    @GeneratedValue(generator=&quot;my_gen&quot;)
    @GenericGenerator(name = &quot;my_gen&quot;, strategy = &quot;increment&quot;)
    public Integer getId() {
        return id;
    }
    public void setId(Integer id) {
        this.id = id;
    }
    public String getName() {
        return name;
    }
    public void setName(String name) {
        this.name = name;
    }
    public String getIdNumber() {
        return idNumber;
    }
    public void setIdNumber(String idNumber) {
        this.idNumber = idNumber;
    }

    @OneToOne(mappedBy=&quot;person&quot;)
    public User getUser() {
        return user;
    }
    public void setUser(User user) {
        this.user = user;
    }

}</code></pre><p>测试类同上</p>
<p><strong>关于上述代码解释：</strong></p>
<ol>
<li>xml<ol>
<li>通过<many-to-one> 元素配置。—–（外键表）<ol>
<li>column 属性指明外键列；</li>
<li>unique 属性设置为 true，表明唯一约束；</li>
<li>cascade 属性设置为 all，表明删除 USER 时同时删除PERSON</li>
<li><code>&lt;many-to-one name=&quot;person&quot; column=&quot;persionId&quot; cascade=&quot;all&quot; unique=&quot;true&quot;/&gt;</code></li>
</ol>
</li>
<li>通过<one-to-one> 元素配置。—–（主键表）<ol>
<li>property-ref 属性，表明建立了从User到Person的一对一关联关系</li>
<li><code>&lt;one-to-one name=&quot;user&quot; property-ref=&quot;person&quot;/&gt;</code></li>
</ol>
</li>
</ol>
</li>
<li>注解<ol>
<li>在User一端的person属性上配置。<ol>
<li>@OneToOne(cascade=CascadeType.ALL)</li>
<li>@JoinColumn(name=”PERSONID”)：指明USER表中的外键列名。</li>
</ol>
</li>
<li>在Person一端的user属性上配置。<ol>
<li>@OneToOne(mappedBy=”person”)</li>
</ol>
</li>
</ol>
</li>
</ol>
<h2 id="组合关系映射"><a href="#组合关系映射" class="headerlink" title="组合关系映射"></a>组合关系映射</h2><p>问题：</p>
<p>某单位职工档案管理系统的需求中，希望能够保存职工的各种联系方式，包括：家庭地址、工作地址、籍贯地址、<br>手机号、邮箱等，每个地址又需包含省、市、县、详细街道信息，应该如何实现？</p>
<table>
<thead>
<tr>
<th align="left">Contact</th>
<th align="left"></th>
</tr>
</thead>
<tbody><tr>
<td align="left">id : int</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">email : String</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">phoneNum : String</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">homeAddress : Address</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">workAddress : Address</td>
<td align="left"></td>
</tr>
</tbody></table>
<table>
<thead>
<tr>
<th align="left">Address</th>
<th align="left"></th>
</tr>
</thead>
<tbody><tr>
<td align="left">province : String</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">city : String</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">district : String</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">detail : String</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">数据库中只有一张contact表，如何添加？</td>
<td align="left"></td>
</tr>
</tbody></table>
<table>
<thead>
<tr>
<th align="left">Contact</th>
<th align="left"></th>
</tr>
</thead>
<tbody><tr>
<td align="left">id : int</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">email : String</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">phoneNum : String</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">homeProvince : String</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">homeCity ： String</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">homeDistrict : String</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">homeDetail : String</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">workProvince : String</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">…</td>
<td align="left"></td>
</tr>
</tbody></table>
<h3 id="xml方式："><a href="#xml方式：" class="headerlink" title="xml方式："></a>xml方式：</h3><p>Contact.java</p>
<pre><code>public class Contact {
    private int id;
    private String phoneNum;
    private String email;
    private Address homeAddress;
    private Address workAddress;
    ...
}</code></pre><p>Contact.hbm.xml</p>
<pre><code>&lt;class name=&quot;Contact&quot;&gt;
    &lt;id name=&quot;id&quot;&gt;
        &lt;generator class=&quot;increment&quot; /&gt;
    &lt;/id&gt;
    &lt;property name=&quot;phoneNum&quot; /&gt;
    &lt;property name=&quot;email&quot; /&gt;

    &lt;!-- component映射组合关系 --&gt;
    &lt;component name=&quot;homeAddress&quot; class=&quot;Address&quot;&gt;
        &lt;property name=&quot;province&quot; column=&quot;HOMEPROVINCE&quot; /&gt;
        &lt;property name=&quot;city&quot; column=&quot;HOMECITY&quot; /&gt;
        &lt;property name=&quot;district&quot; column=&quot;HOMEDISTRICT&quot; /&gt;
        &lt;property name=&quot;detail&quot; column=&quot;HOMEDETAIL&quot; /&gt;
    &lt;/component&gt;
    &lt;component name=&quot;workAddress&quot; class=&quot;Address&quot;&gt;
        &lt;property name=&quot;province&quot; column=&quot;WORKPROVINCE&quot; /&gt;
        &lt;property name=&quot;city&quot; column=&quot;WORKCITY&quot; /&gt;
        &lt;property name=&quot;district&quot; column=&quot;WORKDISTRICT&quot; /&gt;
        &lt;property name=&quot;detail&quot; column=&quot;WORKDETAIL&quot; /&gt;
    &lt;/component&gt;

&lt;/class&gt;</code></pre><p>Address.java</p>
<pre><code>public class Address {
    private String province;//省
    private String city;//市
    private String district;//区
    private String detail;//详细地址
    ...
}</code></pre><p>Test.java</p>
<pre><code>public static void saveContact() {
    Session session = null;
    Transaction tran = null;

    try {
        session = HibernateUtil.openSession();
        tran = session.beginTransaction();

        Contact contact = new Contact();
        contact.setPhoneNum(&quot;12345678910&quot;);
        contact.setEmail(&quot;abcxxx@123.com&quot;);

        Address homeAddress = new Address();
        homeAddress.setProvince(&quot;河北省&quot;);
        homeAddress.setCity(&quot;xx市&quot;);
        homeAddress.setDistrict(&quot;xx区&quot;);
        homeAddress.setDetail(&quot;xx路xx号&quot;);

        Address workAddress = new Address();
        workAddress.setProvince(&quot;河北省&quot;);
        workAddress.setCity(&quot;xx市&quot;);
        workAddress.setDistrict(&quot;xx区&quot;);
        workAddress.setDetail(&quot;xx路xx号&quot;);

        //建立联系
        contact.setHomeAddress(homeAddress);
        contact.setWorkAddress(workAddress);

        // 保存contact同时保存地址信息
        session.save(contact);
        tran.commit();
    } catch (Exception e) {
        tran.rollback();
        e.printStackTrace();
    } finally {    
        session.close();
        HibernateUtil.closeSessionFactory();
    }
}</code></pre><h3 id="注解方式-1"><a href="#注解方式-1" class="headerlink" title="注解方式"></a>注解方式</h3><p>Contact.java</p>
<pre><code>@Entity
public class Contact {

    private int id;
    private String phoneNum;
    private String email;
    private Address homeAddress;
    private Address workAddress;

    @Id
    @GeneratedValue(generator=&quot;my_gen&quot;)
    @GenericGenerator(name = &quot;my_gen&quot;, strategy = &quot;increment&quot;)
    public int getId() {
        return id;
    }

    public void setId(int id) {
        this.id = id;
    }

    public String getPhoneNum() {
        return phoneNum;
    }

    public void setPhoneNum(String phoneNum) {
        this.phoneNum = phoneNum;
    }

    public String getEmail() {
        return email;
    }

    public void setEmail(String email) {
        this.email = email;
    }

    @Embedded
    @AttributeOverrides(value={
            @AttributeOverride(
                    name = &quot;province&quot;, 
                    column = @Column(name=&quot;HOMEPROVINCE&quot;)),
            @AttributeOverride(
                    name = &quot;city&quot;,
                    column = @Column(name=&quot;HOMECITY&quot;)),
            @AttributeOverride(
                    column = @Column(name=&quot;HOMEDISTRICT&quot;),
                    name = &quot;district&quot;),
            @AttributeOverride(
                    column = @Column(name=&quot;HOMEDETAIL&quot;),
                    name = &quot;detail&quot;)})
    public Address getHomeAddress() {
        return homeAddress;
    }

    public void setHomeAddress(Address homeAddress) {
        this.homeAddress = homeAddress;
    }

    @Embedded  //注意与嵌入式类注解@Embeddable区分
    @AttributeOverrides(value={
            @AttributeOverride(
                    name = &quot;province&quot;, 
                    column = @Column(name=&quot;WORKPROVINCE&quot;)),
            @AttributeOverride(
                    name = &quot;city&quot;,
                    column = @Column(name=&quot;WORKCITY&quot;)),
            @AttributeOverride(
                    column = @Column(name=&quot;WORKDISTRICT&quot;),
                    name = &quot;district&quot;),
            @AttributeOverride(
                    column = @Column(name=&quot;WORKDETAIL&quot;),
                    name = &quot;detail&quot;)})
    public Address getWorkAddress() {
        return workAddress;
    }

    public void setWorkAddress(Address workAddress) {
        this.workAddress = workAddress;
    }

}</code></pre><p>Address.java</p>
<pre><code>@Embeddable        //指明为嵌入式类，不需要单独进行映射
public class Address {
    private String province;//省
    private String city;//市
    private String district;//区
    private String detail;//详细地址
    ...

}</code></pre><p>测试类同上</p>

      
      <!-- reward -->
      
    </div>
    
    
      <!-- copyright -->
      
    <footer class="article-footer">
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/mysterious/" rel="tag">mysterious</a></li></ul>


    </footer>

  </div>

  

  
  
  

  

</article>
    
    <article id="post-3-Hibernate继承关系映射" class="article article-type-post" itemscope
  itemprop="blogPost" data-scroll-reveal>

  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2020/02/25/3-Hibernate%E7%BB%A7%E6%89%BF%E5%85%B3%E7%B3%BB%E6%98%A0%E5%B0%84/"
    >3.Hibernate继承关系映射</a
  >
</h2>
  

    </header>
    

    
    <div class="article-meta">
      <a href="/2020/02/25/3-Hibernate%E7%BB%A7%E6%89%BF%E5%85%B3%E7%B3%BB%E6%98%A0%E5%B0%84/" class="article-date">
  <time datetime="2020-02-25T13:19:02.000Z" itemprop="datePublished">2020-02-25</time>
</a>
      
  <div class="article-category">
    <a class="article-category-link" href="/categories/hibernate/">hibernate</a>
  </div>

      
      
      
    </div>
    

    

    
    <div class="article-entry" itemprop="articleBody">
      


      

      
      <p><strong><font size=5 color=#ff0000>每个具体的类实现继承关系映射</strong></font></p>
<p><strong><font size=5 color=#ff0000>父类对应一个表的继承关系映射</strong></font></p>
<p><strong><font size=5 color=#ff0000>每个类对应一个表的继承关系映射</strong></font></p>

      
      <!-- reward -->
      
    </div>
    
    
      <!-- copyright -->
      
    <footer class="article-footer">
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/mysterious/" rel="tag">mysterious</a></li></ul>


    </footer>

  </div>

  

  
  
  

  

</article>
    
    <article id="post-2-Hibernate的单实体映射" class="article article-type-post" itemscope
  itemprop="blogPost" data-scroll-reveal>

  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2020/02/25/2-Hibernate%E7%9A%84%E5%8D%95%E5%AE%9E%E4%BD%93%E6%98%A0%E5%B0%84/"
    >2.Hibernate的单实体映射</a
  >
</h2>
  

    </header>
    

    
    <div class="article-meta">
      <a href="/2020/02/25/2-Hibernate%E7%9A%84%E5%8D%95%E5%AE%9E%E4%BD%93%E6%98%A0%E5%B0%84/" class="article-date">
  <time datetime="2020-02-25T05:05:21.000Z" itemprop="datePublished">2020-02-25</time>
</a>
      
  <div class="article-category">
    <a class="article-category-link" href="/categories/hibernate/">hibernate</a>
  </div>

      
      
      
    </div>
    

    

    
    <div class="article-entry" itemprop="articleBody">
      


      

      
      <h1 id="Hibernate的单实体映射"><a href="#Hibernate的单实体映射" class="headerlink" title="Hibernate的单实体映射"></a>Hibernate的单实体映射</h1><h2 id="单实体的属性映射"><a href="#单实体的属性映射" class="headerlink" title="单实体的属性映射"></a><font size=5 color=#ff0000>单实体的属性映射</font></h2><ol>
<li><p>setter 和 getter 方法优点：有效控制属性的访问权限。<br></p>
</li>
<li><p>property元素的 access 属性；field : 不需要getset方法，通过Java反射机制绕过hibernate直接访问属性值。<br><code>&lt;property name=&quot;userName&quot; access=&quot;field&quot; /&gt;</code></p>
</li>
<li><p>实体映射技巧：实体类属性与表字段不对称时，可以在 setter 和 getter 方法中加入程序逻辑<br><br> 例：User 类中没有 username 属性，而是改为了 firstName 和 lastName 两个属性</p>
<pre><code>public String getUserName() {
    return firstName + &quot; &quot; + lastName;
}

public void setUserName(String userName) {
    String[] strName = userName.split(&quot; &quot;);
    this.firstName = strName[0];
    this.lastName = strName[1];
}</code></pre></li>
<li><p>特殊需求：<br> 例：User 需要订单总额属性，但数据库表中没有这个字段，在property元素的 formula 属性设置查询语句</p>
<pre><code>&lt;property name=&quot;totalPrice&quot; formula=&quot;(select sum(o.price) from orders as o where o.userId=id)&quot;/&gt;</code></pre></li>
<li><p>控制持久化类的insert和update</p>
</li>
</ol>
<table>
<thead>
<tr>
<th align="left">映射属性</th>
<th align="left">作用</th>
</tr>
</thead>
<tbody><tr>
<td align="left">&lt;property&gt;元素的 insert 属性</td>
<td align="left">insert语句中是否包含该属性，默认值为true</td>
</tr>
<tr>
<td align="left">&lt;property&gt;元素的 update 属性</td>
<td align="left">update语句中是否包含该属性，默认值为true</td>
</tr>
<tr>
<td align="left">&lt;class&gt;元素的 mutable 属性</td>
<td align="left">等价于所有property节点的update属性，默认值为true</td>
</tr>
<tr>
<td align="left">&lt;class&gt;元素的 dynamic-insert 属性</td>
<td align="left">值为true等价于所有的property元素dynamic-insert属性为true</td>
</tr>
<tr>
<td align="left">&lt;class&gt;元素的 dynamic-update 属性</td>
<td align="left">值为true等价于所有的property元素dynamic-update属性为true</td>
</tr>
</tbody></table>
<p><em>注：</em><br><br>    1. 会过滤过值为null的属性<br><br>    2. 如果在一个表有很多字段的时候,在做初次insert的时候有比较多的字段为空值,或者经常update某少部分字段,应该在配置文件的<class>元素上将dynamic-insert和dynamic-update设置为true.其默认值都为false.<br><br>    3. dynamic-insert，dynamic-update，提升了数据库的效率，只对需要插入修改的数据进行变动<br></p>
<h2 id="单实体的对象标识符映射"><a href="#单实体的对象标识符映射" class="headerlink" title="单实体的对象标识符映射"></a><font size=5 color=#ff0000>单实体的对象标识符映射</font></h2><p>Java程序中区分不同对象：</p>
<ol>
<li>“==” 比较两个变量引用的内存地址是否相同；</li>
<li>equals可以比较两个变量引用的对象的值是否相同。</li>
<li>用户自定义的类也可以覆盖Object的equals方法实现对象按值进行比较</li>
<li>Hibernate 采用对象标识符（OID）区分对象。</li>
</ol>
<p><img src="https://i.imgur.com/GoQES5W.png" alt=""></p>
<h2 id="使用注解映射单实体"><a href="#使用注解映射单实体" class="headerlink" title="使用注解映射单实体"></a><font size=5 color=#ff0000>使用注解映射单实体</font></h2><p>User.java类：</p>
<pre><code>@Entity                                //声明一个实体类。
@Table(name=&quot;USER&quot;)                    //为实体类指定对应的数据库表
@DynamicInsert(true)
@DynamicUpdate(true)
public class User {
    @Id                       //声明实体类的OID属性
    @GeneratedValue(generator=&quot;my_gen&quot;)        //声明OID的生成策略
    @GenericGenerator(name = &quot;my_gen&quot;, strategy = &quot;increment&quot;)    //使用Hibernate提供的生成策略
    private int id;
    @Column(name=&quot;USERNAME&quot;, insertable=true)
    private String userName;
    @Access(AccessType.FIELD)
    private String password;
    @Formula(value = &quot;(select sum(o.price) from orders as o where o.userid=id)&quot;)//查询语句
    private Double totalPrice;

    public int getId() {
        return id;
    }

    public void setId(int id) {
        this.id = id;
    }

    public String getUserName() {
        return userName;
    }

    public void setUserName(String userName) {
        this.userName = userName;
    }

    public String getPassword() {
        return password;
    }

    public void setPassword(String password) {
        this.password = password;
    }

    public Double getTotalPrice() {
        return totalPrice;
    }

    public void setTotalPrice(Double totalPrice) {
        this.totalPrice = totalPrice;
    }
}</code></pre><p>@Column(name=”columnName”) ：将属性映射到列。<br/></p>
<ol>
<li>name=”columnName”    字段名称；<br/></li>
<li>unique=false            是否在该字段上设置唯一约束；<br/></li>
<li>nullable=true            字段是否能为空；<br/></li>
<li>insertable=true        控制 insert语句；<br/></li>
<li>updatable=true        控制 update语句；<br/></li>
<li>length=255            指定字段长度。<br/></li>
</ol>
<p>@Access(AccessType.PROPERTY)：<br/></p>
<ol>
<li>通过 getter 和 setter 方法访问实体类的属性；<br/></li>
<li>需要在 getter 方法上定义字段的属性。<br/></li>
</ol>
<p>@Access(AccessType.FIELD)：<br/></p>
<ol>
<li>直接访问实体类的属性，可以不定义 getter 和 setter 方法，但是需要将变量定义为public；<br/></li>
<li>需要在变量上定义字段的属性。<br/></li>
</ol>
<p>@Formula：将属性映射到SQL语句。<br/><br><code>@Formula(value = &quot;(select sum(o.price) from     
            orders as o where o.userid=id)&quot;)</code></p>
<p>@DynamicInsert：动态生成 INSERT 语句。<br/></p>
<p>@DynamicUpdate：动态生成 UPDATE 语句。<br/></p>
<h2 id="使用注解和xml方式的区别："><a href="#使用注解和xml方式的区别：" class="headerlink" title="使用注解和xml方式的区别："></a><font color=#0000FF size=10 >使用注解和xml方式的区别：</font></h2><ol>
<li><p><font color=#0000FF size=4 >hibernate.hbm.xml 文件中把引用：xxx.hbm.xml改为引用实体类：</font></p>
<p> 即把：&lt;mapping resource=”com/db/entity/Person.hbm.xml”/&gt;改为：&lt;mapping class=”com.db.entity.Person” /&gt;</p>
</li>
<li><p><font color=#0000FF size=4 >注解方式不需要在xxx.hbm.xml把实体类与表进行映射。而采用在实体类中进行注解。</font></p>
<ol>
<li>实体类属性注解的时候，都注解在<font color=#ff0000>get方法前</font></li>
<li>如果在实体类中某些属性不注解：（属性和get都不写注解），默认为表字段名与实体类属性名一致。</li>
<li>如果实体类的某个成员属性不需要存入数据库中，使用@Transient 进行注解就可以了。即类似于：(xxx.hbm.Xml配置中的某些字段不写(就是不需要对这个成员属性进行映射))</li>
<li>表名称可以在实体类前进行注解。</li>
<li>所有这些注解在：javax.persistence包下。而不是在hibernate包中。</li>
</ol>
</li>
</ol>

      
      <!-- reward -->
      
    </div>
    
    
      <!-- copyright -->
      
    <footer class="article-footer">
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/mysterious/" rel="tag">mysterious</a></li></ul>


    </footer>

  </div>

  

  
  
  

  

</article>
    
    <article id="post-1-Hibernate框架的搭建" class="article article-type-post" itemscope
  itemprop="blogPost" data-scroll-reveal>

  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2020/02/25/1-Hibernate%E6%A1%86%E6%9E%B6%E7%9A%84%E6%90%AD%E5%BB%BA/"
    >1.Hibernate框架的搭建</a
  >
</h2>
  

    </header>
    

    
    <div class="article-meta">
      <a href="/2020/02/25/1-Hibernate%E6%A1%86%E6%9E%B6%E7%9A%84%E6%90%AD%E5%BB%BA/" class="article-date">
  <time datetime="2020-02-25T04:06:04.000Z" itemprop="datePublished">2020-02-25</time>
</a>
      
  <div class="article-category">
    <a class="article-category-link" href="/categories/hibernate/">hibernate</a>
  </div>

      
      
      
    </div>
    

    

    
    <div class="article-entry" itemprop="articleBody">
      


      

      
      <h1 id="Hibernate框架的搭建"><a href="#Hibernate框架的搭建" class="headerlink" title="Hibernate框架的搭建"></a>Hibernate框架的搭建</h1><h2 id="三层体系结构"><a href="#三层体系结构" class="headerlink" title="三层体系结构"></a>三层体系结构</h2><p><img src="https://i.imgur.com/XOwibmV.png" alt=""></p>
<ol>
<li>定义：将系统的组件<strong>分隔到不同的层</strong>中，每一层中的组件应保持内聚性； 每一层都应与它下面的各层保持松散耦合。<br></li>
<li>层与层之间存在自上而下的<strong>依赖关系</strong>，即上层组件会访问下层组件的API，而下层组件不应该依赖上层组件。<br></li>
<li>每个层对上层<strong>公开AP</strong>I，但具体的实现细节对外透明。当某一层的实现发生变化，只要它的API不变，不会影响其他层的实现。</li>
<li>持久层：将数据访问细节和业务逻辑分开（也就是在业务逻辑层和数据库层新添持久层）</li>
<li>持久化：将程序数据在瞬时状态和持久化状态之间转换的机制<ol>
<li>瞬时状态：保存在内存中的数据</li>
<li>持久状态：保存在数据库（磁盘）的程序数据</li>
</ol>
</li>
<li>持久层的作用：为业务逻辑层提供面向对象的API，<strong><em>使业务逻辑层可以专注于实现业务逻辑</em></strong></li>
<li>持久层的目标：<ol>
<li>代码可重用性高，能够完成对象持久化操作；</li>
<li>支持多种数据库平台；</li>
<li>具有相对独立性，当持久层发生变化时，不会影响上层实现。</li>
</ol>
</li>
<li>Hibernate是持久化层框架。</li>
</ol>
<h2 id="软件的模型及ORM"><a href="#软件的模型及ORM" class="headerlink" title="软件的模型及ORM"></a>软件的模型及ORM</h2><p><strong>不同类型的模型：</strong></p>
<p>分析阶段–创建概念模型<br/><br>设计阶段–域模型（面向对象）和数据模型（面向关系）——形成<strong>对象关系映射（ORM）</strong></p>
<pre><code>通过ORM模式在操作实体对象的时候，就不需要再去和复杂的 SQL语句打交道，只需简单的操作实体对象的属性和方法</code></pre><h2 id="Hibernate介绍"><a href="#Hibernate介绍" class="headerlink" title="Hibernate介绍"></a>Hibernate介绍</h2><ol>
<li>在分层体系结构中Hibernate位于持久化层，是完成对象持久化的持久化层框架；<br/></li>
<li>Hibernate是连接Java应用程序和关系型数据库的框架，能够建立对象模型和关系数据模型之间的映射，是一种自动ORM框架；<br/></li>
<li>Hibernate是对JDBC API的封装，是JDBC轻量级封装框架。<br/></li>
</ol>
<h2 id="第一个Hibernate程序"><a href="#第一个Hibernate程序" class="headerlink" title="第一个Hibernate程序"></a>第一个Hibernate程序</h2><h3 id="1-安装Eclipse、Mysql；"><a href="#1-安装Eclipse、Mysql；" class="headerlink" title="1.安装Eclipse、Mysql；"></a>1.安装Eclipse、Mysql；</h3><h3 id="2-下载Hibernate，并解压缩-获得jar包；"><a href="#2-下载Hibernate，并解压缩-获得jar包；" class="headerlink" title="2.下载Hibernate，并解压缩,获得jar包；"></a>2.下载Hibernate，并解压缩,获得jar包；</h3><h3 id="3-使用Eclipse创建新的项目；"><a href="#3-使用Eclipse创建新的项目；" class="headerlink" title="3.使用Eclipse创建新的项目；"></a>3.使用Eclipse创建新的项目；</h3><h3 id="4-引入Hibernate及其依赖库（jar包）；"><a href="#4-引入Hibernate及其依赖库（jar包）；" class="headerlink" title="4.引入Hibernate及其依赖库（jar包）；"></a>4.引入Hibernate及其依赖库（jar包）；</h3><h3 id="5-引入Mysql数据库驱动包；"><a href="#5-引入Mysql数据库驱动包；" class="headerlink" title="5.引入Mysql数据库驱动包；"></a>5.引入Mysql数据库驱动包；</h3><h3 id="6-编写Hibernate配置文件-hibernate-cfg-xml-；"><a href="#6-编写Hibernate配置文件-hibernate-cfg-xml-；" class="headerlink" title="6.编写Hibernate配置文件(hibernate.cfg.xml)；"></a>6.<font color=#FF0000 size=5 >编写Hibernate配置文件(hibernate.cfg.xml)；</font></h3><pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;!DOCTYPE hibernate-configuration PUBLIC &quot;-//Hibernate/Hibernate Configuration DTD 3.0//EN&quot; &quot;http://www.hibernate.org/dtd/hibernate-configuration-3.0.dtd&quot;&gt;

&lt;hibernate-configuration&gt;
&lt;session-factory&gt;
    &lt;property name=&quot;hibernate.dialect&quot;&gt;org.hibernate.dialect.MySQLDialect&lt;/property&gt;
    &lt;property name=&quot;hibernate.connection.driver_class&quot;&gt;com.mysql.jdbc.Driver&lt;/property&gt;
    &lt;property name=&quot;hibernate.connection.url&quot;&gt;jdbc:mysql://localhost:3306/test&lt;/property&gt;
    &lt;property name=&quot;hibernate.connection.characterEncoding&quot;&gt;UTF-8&lt;/property&gt;
    &lt;property name=&quot;hibernate.connection.username&quot;&gt;root&lt;/property&gt;
    &lt;property name=&quot;hibernate.connection.password&quot;&gt;&lt;/property&gt;
    &lt;property name=&quot;hibernate.show_sql&quot;&gt;true&lt;/property&gt;
    &lt;property name=&quot;hibernate.format_sql&quot;&gt;true&lt;/property&gt;

    &lt;mapping resource=&quot;com/hibernate/entity/Customer.hbm.xml&quot; /&gt;
&lt;/session-factory&gt;
&lt;/hibernate-configuration&gt;</code></pre><h3 id="7-创建Java持久化类XXX-java；"><a href="#7-创建Java持久化类XXX-java；" class="headerlink" title="7. 创建Java持久化类XXX.java；"></a>7. <font color=#FF0000 size=5 >创建Java持久化类XXX.java；</font></h3><p><em>持久化类与数据库之间是一一对应关系</em><br/><br><em>Custom.java文件：</em></p>
<pre><code>public class Customer {
    private int id;
    private String name;
    private int sex;
    private int age;
    /*set，get方法*/
}</code></pre><h3 id="8-编写持久化类的映射配置文件XXX-hbm-xml；"><a href="#8-编写持久化类的映射配置文件XXX-hbm-xml；" class="headerlink" title="8. 编写持久化类的映射配置文件XXX.hbm.xml；"></a>8. <font color=#FF0000 size=5 >编写持久化类的映射配置文件XXX.hbm.xml；</font></h3><p>Customer.hbm.xml文件：</p>
<pre><code>&lt;?xml version=&quot;1.0&quot;?&gt;
&lt;!DOCTYPE hibernate-mapping PUBLIC &quot;-//Hibernate/Hibernate Mapping DTD 3.0//EN&quot; &quot;http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd&quot;&gt;

&lt;hibernate-mapping package=&quot;com.hibernate.entity&quot;&gt;
    &lt;class name=&quot;Customer&quot; table=&quot;customer&quot;&gt;
        &lt;id name=&quot;id&quot; type=&quot;int&quot; column=&quot;id&quot;&gt;
            &lt;generator class=&quot;native&quot; /&gt;
        &lt;/id&gt;

        &lt;property name=&quot;name&quot; not-null=&quot;true&quot; type=&quot;java.lang.String&quot; column=&quot;name&quot; /&gt;
        &lt;property name=&quot;sex&quot; type=&quot;int&quot; column=&quot;sex&quot; /&gt;
        &lt;property name=&quot;age&quot; type=&quot;int&quot; column=&quot;age&quot; /&gt;
    &lt;/class&gt;
&lt;/hibernate-mapping&gt;</code></pre><h4 id="介绍配置文件"><a href="#介绍配置文件" class="headerlink" title="介绍配置文件"></a>介绍配置文件</h4><pre><code>1. class元素指定类与表之间的映射
    1. name：类名
    2. table：对应的表名
2. id子元素设定持久化类的OID和表的主键的映射关系
    1. column：指定表字段的名称
    2. generator：元素指定OID的生成器
        1. increment：采用 Hibernate 数值递增的方式；（不适合集群情况）
        2. identity：采用数据库提供的自增长方式；（需设置数据库自增字段）
        3. assigned：主键由应用逻辑产生；（自个设置ID）
        4. native：自动选择合适的标识符生成器；
3. property 子元素设定类的其他属性和表的字段的映射关系
    1. name：对应类的属性名称；
    2. type：指定属性的类型；
    3. column：指定表字段的名称；
    4. not-null：指定属性是否允许为空。</code></pre><ol start="9">
<li><font color=#FF0000 size=5 >使用Hibernate API 完成对象的持久化。</font><br></li>
</ol>
<h4 id="HibernateUtil工具类"><a href="#HibernateUtil工具类" class="headerlink" title="HibernateUtil工具类"></a>HibernateUtil工具类</h4><pre><code>public class HibernateUtil {
    //SessionFactory是线程安全的，多个应用线程间进行共享，一般整个应用有且只有一个SessionFactory
    private static SessionFactory sessionFactory = null;
    /**
     * 静态初始化 Hibernate：创建 StandardServiceRegistry 实例（标准注册服务）
     */
    static {
        StandardServiceRegistry registry = new StandardServiceRegistryBuilder()//创建 StandardServiceRegistryBuilder 实例（标准注册服务生成器）
                                                .configure()//从 hibernate.cfg.xml 配置文件中读取配置信息
                                                .build();//构建 StandardServiceRegistry实例（标准注册服务）
        try {
            // 2 创建 SessionFactory 实例（会话工厂）
            // 2.1 根据标准注册服务创建一个 MetadataSources 实例（元数据资源集）
            // 2.2 构建元数据
            // 2.3 生成SessionFactory 实例（会话工厂）
            sessionFactory = new MetadataSources(registry)
                                        .buildMetadata().buildSessionFactory();
        } catch (Exception e) {
            // 2.4 创建失败手动释放 StandardServiceRegistry
            StandardServiceRegistryBuilder.destroy(registry);
            e.printStackTrace();
        }
    }
    public static SessionFactory getSessionFactory() {
        return sessionFactory;
    }

    public static void closeSessionFactory() {
        sessionFactory.close();
    }</code></pre><h4 id="测试类test-java"><a href="#测试类test-java" class="headerlink" title="测试类test.java"></a>测试类test.java</h4><pre><code>Session session = HibernateUtil.getSessionFactory().openSession();//打开Session
Transaction tx = session.beginTransaction();//开始一个事务
Customer customer = new Customer();//创建需要持久化的对象
customer.setName(&quot;胡宗南&quot;);
customer.setSex(2);
customer.setAge(30);
session.save(customer); //保存
    /*
    Customer customer2=session.get(Customer.class, new Integer(1));//查询

    customer2.setName(&quot;李四&quot;);//修改
    session.update(customer2);

    session.delete(customer2);//删除
    */
tx.commit();//提交事务
session.close();关闭 Session,SessionFactory
HibernateUtil.closeSessionFactory();</code></pre><p>}</p>

      
      <!-- reward -->
      
    </div>
    
    
      <!-- copyright -->
      
    <footer class="article-footer">
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/mysterious/" rel="tag">mysterious</a></li></ul>


    </footer>

  </div>

  

  
  
  

  

</article>
    
    <article id="post-hello-world" class="article article-type-post" itemscope
  itemprop="blogPost" data-scroll-reveal>

  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2020/02/25/hello-world/"
    >Hello World</a
  >
</h2>
  

    </header>
    

    
    <div class="article-meta">
      <a href="/2020/02/25/hello-world/" class="article-date">
  <time datetime="2020-02-25T03:38:07.680Z" itemprop="datePublished">2020-02-25</time>
</a>
      
      
      
      
    </div>
    

    

    
    <div class="article-entry" itemprop="articleBody">
      


      

      
      <p>Welcome to <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/" target="_blank" rel="noopener">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html" target="_blank" rel="noopener">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="noopener">GitHub</a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">"My New Post"</span></span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/writing.html" target="_blank" rel="noopener">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/server.html" target="_blank" rel="noopener">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/generating.html" target="_blank" rel="noopener">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/one-command-deployment.html" target="_blank" rel="noopener">Deployment</a></p>

      
      <!-- reward -->
      
    </div>
    
    
      <!-- copyright -->
      
    <footer class="article-footer">
      
      

    </footer>

  </div>

  

  
  
  

  

</article>
    
  </article>
  

  
</section>
</div>

      <footer class="footer">
  <div class="outer">
    <ul class="list-inline">
      <li>
        &copy;
        2019-2020
        John Doe
      </li>
      <li>
        
          Powered by
        
        
        <a href="https://hexo.io" target="_blank">Hexo</a> Theme <a href="https://github.com/Shen-Yu/hexo-theme-ayer" target="_blank">Ayer</a>
        
      </li>
    </ul>
    <ul class="list-inline">
      <li>
        
        
        <span>
  <i>PV:<span id="busuanzi_value_page_pv"></span></i>
  <i>UV:<span id="busuanzi_value_site_uv"></span></i>
</span>
        
      </li>
      <li>
        <!-- cnzz统计 -->
        
        <script type="text/javascript" src='https://s9.cnzz.com/z_stat.php?id=1278069914&amp;web_id=1278069914'></script>
        
      </li>
    </ul>
  </div>
</footer>
    <div class="to_top">
        <div class="totop" id="totop">
  <i class="ri-arrow-up-line"></i>
</div>
      </div>
    </main>
      <aside class="sidebar">
        <button class="navbar-toggle"></button>
<nav class="navbar">
  
  <div class="logo">
    <a href="/"><img src="/images/ayer-side.svg" alt="神秘的小胖纸"></a>
  </div>
  
  <ul class="nav nav-main">
    
    <li class="nav-item">
      <a class="nav-item-link" href="/">主页</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/archives">归档</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/categories">分类</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/tags">标签</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/about">关于我</a>
    </li>
    
  </ul>
</nav>
<nav class="navbar navbar-bottom">
  <ul class="nav">
    <li class="nav-item">
      
      <a class="nav-item-link nav-item-search"  title="Search">
        <i class="ri-search-line"></i>
      </a>
      
      
      <a class="nav-item-link" target="_blank" href="/atom.xml" title="RSS Feed">
        <i class="ri-rss-line"></i>
      </a>
      
    </li>
  </ul>
</nav>
<div class="search-form-wrap">
  <div class="local-search local-search-plugin">
  <input type="search" id="local-search-input" class="local-search-input" placeholder="Search...">
  <div id="local-search-result" class="local-search-result"></div>
</div>
</div>
      </aside>
      <div id="mask"></div>

<!-- #reward -->
<div id="reward">
  <span class="close"><i class="ri-close-line"></i></span>
  <p class="reward-p"><i class="ri-cup-line"></i>请我喝杯咖啡吧~</p>
  <div class="reward-box">
    
    <div class="reward-item">
      <img class="reward-img" src="/images/alipay.jpg">
      <span class="reward-type">支付宝</span>
    </div>
    
    
    <div class="reward-item">
      <img class="reward-img" src="/images/wechat.jpg">
      <span class="reward-type">微信</span>
    </div>
    
  </div>
</div>
      
<script src="/js/jquery-2.0.3.min.js"></script>


<script src="/js/jquery.justifiedGallery.min.js"></script>


<script src="/js/lazyload.min.js"></script>


<script src="/js/busuanzi-2.3.pure.min.js"></script>


<script src="/js/share.js"></script>



<script src="/fancybox/jquery.fancybox.min.js"></script>




<script>
  try {
    var typed = new Typed("#subtitle", {
    strings: ['面朝大海，春暖花开','愿你一生努力，一生被爱','想要的都拥有，得不到的都释怀'],
    startDelay: 0,
    typeSpeed: 200,
    loop: true,
    backSpeed: 100,
    showCursor: true
    });
  } catch (err) {
  }
  
</script>




<script>
  var ayerConfig = {
    mathjax: false
  }
</script>


<script src="/js/ayer.js"></script>


<script src="https://cdn.jsdelivr.net/npm/jquery-modal@0.9.2/jquery.modal.min.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jquery-modal@0.9.2/jquery.modal.min.css">


<!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" style="display:none" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.css">
<script src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"></script>

<script>
    function viewer_init() {
        let pswpElement = document.querySelectorAll('.pswp')[0];
        let $imgArr = document.querySelectorAll(('.article-entry img:not(.reward-img)'))

        $imgArr.forEach(($em, i) => {
            $em.onclick = () => {
                // slider展开状态
                // todo: 这样不好，后面改成状态
                if (document.querySelector('.left-col.show')) return
                let items = []
                $imgArr.forEach(($em2, i2) => {
                    let img = $em2.getAttribute('data-idx', i2)
                    let src = $em2.getAttribute('data-target') || $em2.getAttribute('src')
                    let title = $em2.getAttribute('alt')
                    // 获得原图尺寸
                    const image = new Image()
                    image.src = src
                    items.push({
                        src: src,
                        w: image.width || $em2.width,
                        h: image.height || $em2.height,
                        title: title
                    })
                })
                var gallery = new PhotoSwipe(pswpElement, PhotoSwipeUI_Default, items, {
                    index: parseInt(i)
                });
                gallery.init()
            }
        })
    }
    viewer_init()
</script>




<script type="text/javascript" src="https://js.users.51.la/20544303.js"></script>
  </div>
</body>

</html>